# UniFi Security Report

A containerized service that monitors UniFi network logs and delivers plain-English security reports via email or file.

## Features

- **Log Collection**: Fetches events and alarms from UniFi Controller API with WebSocket support for UniFi 10.x+
- **Smart Analysis**: Categorizes issues by severity (low, medium, severe) with deduplication
- **Plain English Reports**: Generates human-readable explanations with remediation steps
- **IPS/IDS Analysis**: Translates Suricata signatures into plain English with threat context
- **Device Health Monitoring**: Tracks temperature, CPU, memory, and PoE status across devices
- **Flexible Delivery**: Email (BCC recipients, severity-aware subjects) or file output
- **Scheduled Execution**: Cron expressions, presets (daily_8am, weekly_monday_8am), or one-shot mode
- **Docker Ready**: Multi-stage build with health checks and non-root user

## Example Report

The scanner generates HTML email reports like this:

<table><tr><td>
<h3 style="background:#2282FF;color:#fff;padding:15px 20px;margin:0;border-radius:4px 4px 0 0;">UniFi Security Report<br><small style="font-weight:normal;opacity:0.9">Home Network</small></h3>
<div style="padding:20px;background:#fff;border:1px solid #e9ecef;border-top:none;">

**Executive Summary**

| ðŸ”´ SEVERE | ðŸŸ  MEDIUM | âšª LOW |
|:---------:|:---------:|:------:|
| 2 | 5 | 12 |

---

**ðŸ”´ SEVERE: IPS Alert - Malware Communication Detected**

Blocked connection attempt to known malware command & control server from device 192.168.1.105. Signature: ET MALWARE Win32/Emotet CnC Activity

> **Recommended Action:** Isolate the affected device immediately. Run a full malware scan. Check for unauthorized software installations.

---

**ðŸ”´ SEVERE: Access Point Temperature Critical**

U6-Pro (Office) temperature is 92Â°C, exceeding critical threshold of 85Â°C.

> **Recommended Action:** Check ventilation around the device. Consider relocating to a cooler area.

---

**ðŸŸ  MEDIUM: Client Roaming Excessively**

iPhone-John roamed between access points 8 times in the last hour, indicating possible coverage gaps or interference.

> **Recommended Action:** Check for overlapping channel usage. Adjust transmit power or add coverage in weak areas.

---

**Security Threat Summary** â€” 3 threats from 2 unique IPs

| Threat | Category | Action | Sources |
|--------|----------|--------|---------|
| ET SCAN Nmap Scripting Engine | Network Scanning | Blocked | 45.33.32.156 (2) |
| ET MALWARE Win32/Emotet | Malware | Blocked | 192.168.1.105 (1) |

---

**Device Health Summary** â€” 1 critical, 2 warnings across 8 devices

| Device | Status | Details |
|--------|--------|---------|
| U6-Pro (Office) | ðŸ”´ Temperature: 92Â°C | Uptime: 45d, CPU: 12%, Memory: 34% |
| USW-24-PoE | ðŸŸ  PoE Budget: 89% | Uptime: 120d, CPU: 8%, Memory: 45% |

</div>
<div style="background:#f8f9fa;padding:10px;text-align:center;font-size:12px;color:#6c757d;border:1px solid #e9ecef;border-top:none;border-radius:0 0 4px 4px;">
Generated by UniFi Scanner v0.3.5a1
</div>
</td></tr></table>

## Quick Start

### Docker Compose

```bash
# Create secrets
mkdir -p secrets
echo "your-unifi-password" > secrets/unifi_password.txt
echo "your-smtp-password" > secrets/smtp_password.txt

# Configure environment
cat > .env << 'ENVEOF'
UNIFI_HOST=192.168.1.1
UNIFI_USERNAME=admin
UNIFI_SCHEDULE_PRESET=daily_8am
UNIFI_SCHEDULE_TIMEZONE=America/New_York
ENVEOF

# Run
docker-compose up -d
```

### Pull from GitHub Container Registry

```bash
docker pull ghcr.io/trek-e/unifi-security-report:latest
```

### Local Installation

```bash
pip install -e .
unifi-scanner --help
```

## Configuration

| Variable | Description | Default |
|----------|-------------|---------|
| `UNIFI_HOST` | Controller hostname/IP | Required |
| `UNIFI_USERNAME` | Admin username | Required |
| `UNIFI_PASSWORD` | Admin password | Required |
| `UNIFI_SITE` | Site name | Auto-detect |
| `UNIFI_SCHEDULE_PRESET` | Schedule preset | `daily_8am` |
| `UNIFI_SCHEDULE_CRON` | Cron expression | None |
| `UNIFI_EMAIL_ENABLED` | Enable email delivery | `false` |
| `UNIFI_FILE_ENABLED` | Enable file output | `false` |

See `docker-compose.yml` for all options.

## Version History

| Version | Phase | Features |
|---------|-------|----------|
| v0.3.4a1 | 10 | Integration infrastructure for external services |
| v0.3.3a1 | 9 | Device health monitoring (temperature, CPU, memory, PoE) |
| v0.3.2a1 | 8 | Enhanced IPS/IDS analysis with remediation guidance |
| v0.3.1a1 | 7 | Extended wireless analysis (roaming, DFS, RSSI) |
| v0.3.0a1 | 6 | State persistence to prevent duplicate reports |
| v0.2.0a1 | 1-5 | Production-ready containerized service |

## License

MIT
